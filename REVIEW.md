---
title: "Web Casual Games - 代碼審查報告"
fontSize: 12
header: "Code Review Report - 2026-02-02"
footer: "Shimma Games Internal"
---

# 代碼審查報告 (Code Review Report)

**項目名稱**: `web-casual-games`
**審查時間**: 2026年2月2日
**審查員**: AI Assistant (OpenClaw)

## 1. 概覽
本次審查涵蓋了項目中的三個主要遊戲：
- **Cat Café Tycoon** (增量放置類)
- **Neon Snake 2077** (動作街機類)
- **Color Alchemy** (邏輯解謎類)

整體代碼結構清晰，語義化良好，且針對移動端進行了適配。

## 2. 已修復的關鍵問題 (Critical Fixes Applied)

在審查過程中發現並修復了以下問題：

### 🛠️ Neon Snake 2077
- **問題**: 當瀏覽器標籤頁切換或系統卡頓時，遊戲循環的 `dt` (時間差) 會變得極大，導致遊戲邏輯「快進」，蛇會瞬間撞牆死亡 (Spiral of Death)。
- **修復**: 在 `gameLoop` 中增加了 `dt` 的上限 (500ms)。即使發生卡頓，遊戲也只會處理有限的邏輯步數。

### 🛠️ Color Alchemy
- **問題**: T型管道 (Type 3) 的邏輯連接方向 (上、右、下) 與視覺 SVG 路徑 (上、右、左) 不匹配，導致玩家視覺上連接正確但無法通關。
- **修復**: 修正了 `isConnected` 函數中的判斷邏輯，現在邏輯與視覺 (上、右、左) 保持一致。

### 🛠️ Cat Café Tycoon
- **問題**: 在 iOS Safari 上，`beforeunload` 事件觸發不穩定，可能導致玩家退出時存檔失敗。
- **修復**: 增加了 `pagehide` 事件監聽器，這是移動端瀏覽器更推薦的頁面卸載事件。

## 3. 改進建議 (Suggestions for Improvement)

以下建議非緊急，但能進一步提升品質：

### 🚀 性能優化 (Performance)
1.  **物件池 (Object Pooling) - Neon Snake**:
    - 目前每次吃掉食物產生的粒子效果都會 `new Particle()`。
    - **建議**: 預先建立一個粒子池重複使用，減少垃圾回收 (GC) 壓力，特別是對低階手機有幫助。

2.  **休眠優化 - Cat Café**:
    - 目前即使在後台，`requestAnimationFrame` 仍可能嘗試運行。
    - **建議**: 使用 `document.hidden` 檢測，當頁面不可見時暫停渲染循環，僅保留邏輯計算，以節省設備電量。

### 📱 響應式體驗 (Responsiveness)
1.  **Cat Café**:
    - 在極小屏幕 (如 iPhone SE) 上，`height: 500px` 的固定高度可能導致升級面板被擠出畫面。
    - **建議**: 使用 `flex: 1` 或 `min-height` 代替固定高度。

### 🧩 代碼架構 (Architecture)
1.  **共用資源**:
    - 目前每個遊戲都獨立引入了字體和 Reset CSS。
    - **建議**: 建立 `assets/css/common.css` 和 `assets/js/utils.js`，將通用樣式和函數 (如 `saveGame`, `isMobile`) 提取出來。

## 4. 總結
項目整體質量優秀，修復上述關鍵 Bug 後，已具備發布水準。建議在下個版本迭代中考慮上述性能優化方案。

---
*Generated by OpenClaw*
